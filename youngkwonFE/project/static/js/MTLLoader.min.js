THREE.MTLLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(t,a,r,e){var s=this,i=void 0===this.path?THREE.LoaderUtils.extractUrlBase(t):this.path,o=new THREE.FileLoader(this.manager);o.setPath(this.path),o.load(t,function(t){a(s.parse(t,i))},r,e)},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setTexturePath:function(t){return console.warn("THREE.MTLLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)},setCrossOrigin:function(t){return this.crossOrigin=t,this},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,a){for(var r=t.split("\n"),e={},s=/\s+/,i={},o=0;o<r.length;o++){var n=r[o];if(0!==(n=n.trim()).length&&"#"!==n.charAt(0)){var h=n.indexOf(" "),p=h>=0?n.substring(0,h):n;p=p.toLowerCase();var l=h>=0?n.substring(h+1):"";if(l=l.trim(),"newmtl"===p)e={name:l},i[l]=e;else if("ka"===p||"kd"===p||"ks"===p){var c=l.split(s,3);e[p]=[parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2])]}else e[p]=l}}var u=new THREE.MTLLoader.MaterialCreator(this.resourcePath||a,this.materialOptions);return u.setCrossOrigin(this.crossOrigin),u.setManager(this.manager),u.setMaterials(i),u}},THREE.MTLLoader.MaterialCreator=function(t,a){this.baseUrl=t||"",this.options=a,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var a={};for(var r in t){var e=t[r],s={};for(var i in a[r]=s,e){var o=!0,n=e[i],h=i.toLowerCase();switch(h){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[2]&&(o=!1)}o&&(s[h]=n)}}return a},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0;for(var a in this.materialsInfo)this.materialsArray[t]=this.create(a),this.nameLookup[a]=t,t++;return this.materialsArray},create:function(t){return void 0===this.materials[t]&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){var a=this,r=this.materialsInfo[t],e={name:t,side:this.side};function s(t,r){if(!e[t]){var s,i,o=a.getTextureParams(r,e),n=a.loadTexture((s=a.baseUrl,"string"!=typeof(i=o.url)||""===i?"":/^https?:\/\//i.test(i)?i:s+i));n.repeat.copy(o.scale),n.offset.copy(o.offset),n.wrapS=a.wrap,n.wrapT=a.wrap,e[t]=n}}for(var i in r){var o,n=r[i];if(""!==n)switch(i.toLowerCase()){case"kd":e.color=(new THREE.Color).fromArray(n);break;case"ks":e.specular=(new THREE.Color).fromArray(n);break;case"map_kd":s("map",n);break;case"map_ks":s("specularMap",n);break;case"norm":s("normalMap",n);break;case"map_bump":case"bump":s("bumpMap",n);break;case"map_d":s("alphaMap",n),e.transparent=!0;break;case"ns":e.shininess=parseFloat(n);break;case"d":(o=parseFloat(n))<1&&(e.opacity=o,e.transparent=!0);break;case"tr":o=parseFloat(n),this.options&&this.options.invertTrProperty&&(o=1-o),o>0&&(e.opacity=1-o,e.transparent=!0)}}return this.materials[t]=new THREE.MeshPhongMaterial(e),this.materials[t]},getTextureParams:function(t,a){var r,e={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},s=t.split(/\s+/);return(r=s.indexOf("-bm"))>=0&&(a.bumpScale=parseFloat(s[r+1]),s.splice(r,2)),(r=s.indexOf("-s"))>=0&&(e.scale.set(parseFloat(s[r+1]),parseFloat(s[r+2])),s.splice(r,4)),(r=s.indexOf("-o"))>=0&&(e.offset.set(parseFloat(s[r+1]),parseFloat(s[r+2])),s.splice(r,4)),e.url=s.join(" ").trim(),e},loadTexture:function(t,a,r,e,s){var i,o=THREE.Loader.Handlers.get(t),n=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===o&&(o=new THREE.TextureLoader(n)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin),i=o.load(t,r,e,s),void 0!==a&&(i.mapping=a),i}};