let scene,camera,renderer,cloudGeo,cloudMaterial,flash,rain,rainGeo,cloudParticles=[],rainCount=15e3,verticies=[],divWidth=window.innerWidth,divHeight=window.innerHeight;function init(){scene=new THREE.Scene,(camera=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1e3)).position.z=1,camera.position.x=1.16,camera.rotation.y=-.12,camera.rotation.z=.27,ambient=new THREE.AmbientLight(5592405),scene.add(ambient),directionalLight=new THREE.DirectionalLight(16772829),directionalLight.position.set(0,0,1),scene.add(directionalLight),(flash=new THREE.PointLight(404873,30,500,1.7)).position.set(200,300,100),scene.add(flash),(renderer=new THREE.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),document.body.appendChild(renderer.domElement);for(let e=0;e<rainCount;e++)rainDrop=new THREE.Vector3(400*Math.random()-200,500*Math.random()-250,400*Math.random()-200),rainDrop.velocity={},rainDrop.velocity=0,verticies.push(rainDrop);rainGeo=(new THREE.BufferGeometry).setFromPoints(verticies),rainMaterial=new THREE.PointsMaterial({color:11184810,size:.1,transparent:!0}),rain=new THREE.Points(rainGeo,rainMaterial),scene.add(rain),(new THREE.TextureLoader).load("../image/cloud-texture.png",function(e){cloudGeo=new THREE.PlaneBufferGeometry(500,500),cloudMaterial=new THREE.MeshLambertMaterial({map:e,transparent:!0});for(let e=0;e<40;e++){let e=new THREE.Mesh(cloudGeo,cloudMaterial);e.position.set(Math.random()*divWidth-200,Math.random()*divHeight-120,500*Math.random()-450),e.rotation.x=1.16,e.rotation.y=-.12,e.rotation.z=360*Math.random(),e.material.opacity=.8,cloudParticles.push(e),scene.add(e)}animate()})}function animate(){cloudParticles.forEach(e=>{e.rotation.z-=.002});for(let e=0;e<verticies.length;e++)verticies[e].velocity+=verticies[e].acceleration,verticies[e].y-=verticies[e].velocity,verticies[e].y<-200&&(verticies[e].y=200,verticies[e].velocity=0);rainGeo.setFromPoints(verticies),(Math.random()>.93||flash.power>100)&&(flash.position.set(Math.random()*divWidth,300+Math.random()*divHeight,100),flash.power+=50+500*Math.random()),renderer.render(scene,camera),requestAnimationFrame(animate)}init();